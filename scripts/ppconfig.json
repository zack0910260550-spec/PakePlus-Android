{"name":"xiaoya","url":"https://777tv.ai/","showName":"xiaoya","appid":"com.xiaoya.app","icon":"","iconRound":true,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":true,"version":"0.0.4","preview":"Android","platform":["1-1"],"width":412,"height":915,"desc":"","jsFile":[],"filterCss":"","customJs":"/***** 0) 內開連結（保留你原本的行為） *****/\nconst hookClick = (e) => {\n  const a = e.target.closest('a[href]');\n  const baseBlank = document.querySelector('head base[target=\"_blank\"]');\n  if ((a && a.target === '_blank') || (a && baseBlank)) {\n    e.preventDefault(); location.href = a.href;\n  }\n};\nwindow.open = (url)=>{ location.href = url; };\ndocument.addEventListener('click', hookClick, { capture:true });\n\n/***** 1) 螢幕常亮（替代 WAKE_LOCK 權限） *****/\n(async function keepAwake(){\n  if ('wakeLock' in navigator) {\n    let lock;\n    const req = async ()=>{ try { lock = await navigator.wakeLock.request('screen'); } catch(e){} };\n    const rel = ()=>{ try { lock && lock.release && lock.release(); } catch(e){} };\n    document.addEventListener('visibilitychange', ()=> {\n      if (document.visibilityState === 'visible') req(); else rel();\n    });\n    await req();\n  }\n})();\n\n/***** 2) UI 放大 + 焦點樣式 + 讓頂部導航可聚焦 *****/\n(() => {\n  const css = document.createElement('style');\n  css.textContent = `\n    html,body{font-size:20px;line-height:1.5}\n    a,button,input,select,textarea,video{outline:0}\n    *:focus{box-shadow:0 0 0 3px #2ea3ff99 !important;border-radius:6px}\n    ::-webkit-scrollbar{width:0;height:0}\n    header a, header button, .nav a, .menu a { padding:8px 12px; display:inline-block }\n  `;\n  document.head.appendChild(css);\n\n  const topSel = [\n    'header nav a','.nav a','.menu a',\n    'header a','header button',\n    'input[type=\"search\"]','input[placeholder*=\"搜\"]'\n  ].join(',');\n  document.querySelectorAll(topSel).forEach(el=>{\n    if (!el.hasAttribute('tabindex')) el.setAttribute('tabindex','0');\n  });\n})();\n\n/***** 3) 封面圖修復（lazyload / 防盜鏈 / srcset） *****/\nfunction fixOneImg(img){\n  if (!img) return;\n  const isPlaceholder = (s)=> !s || /placeholder|data:image\\/svg|base64/i.test(s);\n  const cur = img.getAttribute('src');\n  const ds  = img.getAttribute('data-src') || img.getAttribute('data-original') || img.getAttribute('data-url');\n  const ss  = img.getAttribute('data-srcset') || img.getAttribute('srcset');\n\n  if (isPlaceholder(cur) && ds) img.setAttribute('src', ds);\n  if (ss && !img.getAttribute('srcset')) img.setAttribute('srcset', ss);\n\n  img.loading = 'eager';\n  img.referrerPolicy = 'no-referrer';\n  img.crossOrigin = 'anonymous';\n\n  img.addEventListener('error', async ()=>{\n    try{\n      const url = ds || cur || (ss ? ss.split(' ')[0] : '');\n      if (!url) return;\n      const res = await fetch(url, {mode:'cors', credentials:'omit'});\n      if (!res.ok) return;\n      const blob = await res.blob();\n      img.src = URL.createObjectURL(blob);\n    }catch(e){}\n  }, {once:true});\n}\nfunction forceLoadImages(){\n  document.querySelectorAll('img').forEach(fixOneImg);\n  window.dispatchEvent(new Event('scroll'));\n  window.dispatchEvent(new Event('resize'));\n  window.scrollBy(0,1); window.scrollBy(0,-1);\n}\ndocument.addEventListener('DOMContentLoaded', ()=>setTimeout(forceLoadImages, 300));\nsetInterval(forceLoadImages, 2000);\n\n/***** 4) 空間導覽（方向鍵找最近元素） *****/\nfunction rectCenter(r){ return {x:r.left+r.width/2, y:r.top+r.height/2}; }\nfunction focusables(){\n  const sel='a,button,[role=\"button\"],input,select,textarea,[tabindex]:not([tabindex=\"-1\"]),video';\n  return Array.from(document.querySelectorAll(sel))\n    .filter(el=>{\n      const s=getComputedStyle(el), r=el.getBoundingClientRect();\n      return s.display!=='none' && s.visibility!=='hidden' && r.width>4 && r.height>4 && !el.disabled;\n    });\n}\nfunction bestInDirection(dir){\n  const list = focusables(); if(!list.length) return null;\n  const cur  = document.activeElement && list.includes(document.activeElement) ? document.activeElement : null;\n  const cb   = cur ? cur.getBoundingClientRect() : {left:0,top:0,width:0,height:0};\n  const c    = cur ? rectCenter(cb) : {x:window.innerWidth/2, y:window.innerHeight/3};\n  let best=null, bestScore=Infinity;\n  for(const el of list){\n    if (el===cur) continue;\n    const r = el.getBoundingClientRect(), p = rectCenter(r);\n    const dx = p.x - c.x, dy = p.y - c.y;\n    if (dir==='right' && dx<=4) continue;\n    if (dir==='left'  && dx>=-4) continue;\n    if (dir==='down'  && dy<=4) continue;\n    if (dir==='up'    && dy>=-4) continue;\n    const ang = Math.atan2(Math.abs(dir==='left'||dir==='right'?dy:dx), Math.abs(dir==='left'||dir==='right'?dx:dy));\n    const dist = Math.hypot(dx,dy);\n    const score = ang*200 + dist;\n    if (score < bestScore) { bestScore=score; best=el; }\n  }\n  return best;\n}\nfunction move(dir){\n  const target = bestInDirection(dir);\n  if (target){\n    target.focus(); target.scrollIntoView({block:'center', inline:'center', behavior:'smooth'});\n  }else{\n    const dy = (dir==='down'?1:dir==='up'?-1:0)*window.innerHeight*0.6;\n    if (dy) window.scrollBy({top:dy, behavior:'smooth'});\n  }\n}\nfunction focusTopBar(){\n  const top = document.querySelector('header nav a, .nav a, .menu a, input[type=\"search\"], input[placeholder*=\"搜\"]');\n  if (top){ top.focus(); top.scrollIntoView({block:'center'}); }\n}\n\n/***** 5) 影片輔助：自動播放/全螢幕、長按快進退、媒體鍵 *****/\nfunction video(){ return document.querySelector('video'); }\nfunction autoPlayFull(){\n  const v = video(); if(!v) return;\n  const go = ()=>{ v.play().catch(()=>{}); v.requestFullscreen?.().catch(()=>{}); };\n  (v.readyState>=2)?go():v.addEventListener('canplay', go, {once:true});\n}\ndocument.addEventListener('DOMContentLoaded', autoPlayFull);\n\nlet seekTimer=null;\nfunction startSeek(delta){\n  stopSeek();\n  seekTimer=setInterval(()=>{\n    const v=video(); if(v&&document.fullscreenElement){ v.currentTime = Math.max(0, Math.min((v.currentTime||0)+delta, v.duration||1)); }\n  }, 200);\n}\nfunction stopSeek(){ if(seekTimer){ clearInterval(seekTimer); seekTimer=null; }}\n\n/***** 6) 鍵位對應（方向鍵、OK、返回、空白鍵、媒體鍵、數字鍵） *****/\nlet lastUp=0;\ndocument.addEventListener('keydown', (e)=>{\n  const v = video();\n  if (['ArrowUp','ArrowDown','ArrowLeft','ArrowRight','Enter','Backspace','Escape',' '].includes(e.key)) e.preventDefault();\n\n  if (e.key==='ArrowUp'){\n    const now = Date.now();\n    if (now - lastUp < 300) { focusTopBar(); } else { move('up'); }\n    lastUp = now;\n  } else if (e.key==='ArrowDown'){ move('down'); }\n  else if (e.key==='ArrowLeft'){\n    if (v && document.fullscreenElement){ v.currentTime = Math.max(0,(v.currentTime||0)-10); }\n    else move('left');\n  } else if (e.key==='ArrowRight'){\n    if (v && document.fullscreenElement){ v.currentTime = Math.min((v.currentTime||0)+10, v.duration||1); }\n    else move('right');\n  } else if (e.key==='Enter'){ // OK\n    if (document.activeElement?.tagName === 'VIDEO'){ v && (v.paused ? v.play().catch(()=>{}) : v.pause()); }\n    else { document.activeElement?.click(); }\n  } else if (e.key===' ' && v){ v.paused ? v.play().catch(()=>{}) : v.pause(); }\n  else if (e.key==='Escape' || e.key==='Backspace'){\n    if (document.fullscreenElement){ document.exitFullscreen().catch(()=>{}); }\n    else if (history.length>1){ history.back(); }\n  }\n\n  // 媒體鍵\n  if (e.code === 'MediaPlayPause' && v){ v.paused ? v.play().catch(()=>{}) : v.pause(); }\n  if (e.code === 'MediaTrackNext'  && v && document.fullscreenElement){ v.currentTime = Math.min((v.currentTime||0)+10, v.duration||1); }\n  if (e.code === 'MediaTrackPrevious' && v && document.fullscreenElement){ v.currentTime = Math.max(0,(v.currentTime||0)-10); }\n  if (e.key === 'ContextMenu' || e.key === 'Help'){ focusTopBar(); } // 菜單鍵/說明鍵 → 聚焦頂部\n\n  // 數字鍵 0~9 跳百分比\n  if (/^[0-9]$/.test(e.key) && v && v.duration){ v.currentTime = v.duration * (parseInt(e.key,10)/10); }\n}, true);\n\n// 長按左右連續快轉\ndocument.addEventListener('keydown', (e)=>{\n  if (e.repeat && (e.key==='ArrowLeft' || e.key==='ArrowRight')){\n    startSeek(e.key==='ArrowRight'?+2:-2);\n  }\n});\ndocument.addEventListener('keyup', (e)=>{\n  if (e.key==='ArrowLeft' || e.key==='ArrowRight') stopSeek();\n});\n\n/***** 7) 避免外跳：把 target=_blank 改成 _self *****/\ndocument.addEventListener('DOMContentLoaded', ()=>{\n  document.querySelectorAll('a[target=\"_blank\"]').forEach(a=>a.setAttribute('target','_self'));\n});\n","isHtml":false,"htmlPath":"","htmlFiles":[],"more":{"windows":{"label":"","title":"","url":"https://777tv.ai/","userAgent":"Mozilla/5.0 (Linux; Android 14; Pixel 6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Mobile Safari/537.36","width":1920,"height":1080,"theme":null,"resizable":false,"fullscreen":true,"maximized":false,"minWidth":1920,"minHeight":1080,"maxWidth":1920,"maxHeight":1080,"decorations":false,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":false,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":true,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false,"additionalBrowserArgs":"--enable-features=OverlayScrollbar,MediaSessionService --disable-features=Translate,AutofillServerCommunication --autoplay-policy=no-user-gesture-required"}},"phone":{"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]},"webview":{"userAgent":"Mozilla/5.0 (Linux; Android 11; ADT-3 Build/RTT3.210718.002) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.40 Safari/537.36 CrKey/1.54.248666","javaScriptEnabled":true,"domStorageEnabled":true,"allowFileAccess":true,"loadWithOverviewMode":true,"setSupportZoom":true,"clearCache":true}},"ios":{"name":"xiaoya","showName":"xiaoya","version":"0.0.4","webUrl":"https://777tv.ai/","id":"com.xiaoya.app.ios","icon":"./app-icon.png","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false},"android":{"name":"xiaoya","showName":"xiaoya","version":"0.0.4","webUrl":"https://777tv.ai/","id":"com.xiaoya.app.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false},"desktop":{"name":"xiaoya","showName":"xiaoya","version":"0.0.4","id":"com.xiaoya.app.desktop","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途，否则后果自负）","webUrl":"https://777tv.ai/","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途，否则后果自负）","isHtml":false,"single":true,"state":true,"injectJq":false,"tauriApi":false,"buildMethod":"local","debug":false}}